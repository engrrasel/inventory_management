<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Inventory Dashboard</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { background-color: #f9fafb; font-family: 'Inter', sans-serif; }
    .sidebar {
      width: 230px; background: #1e3a8a; height: 100vh; color: white;
      position: fixed; display: flex; flex-direction: column; padding: 25px;
    }
    .sidebar h3 { color: #fff; margin-bottom: 30px; }
    .sidebar a { color: #cbd5e1; text-decoration: none; margin: 10px 0; display: block; }
    .sidebar a:hover { color: #fff; }
    .content { margin-left: 250px; padding: 30px; }
    .card { border-radius: 16px; transition: 0.2s; }
    .card:hover { transform: scale(1.02); }
    .low-stock { color: red; font-weight: bold; }
  </style>
</head>
<body>
  <div class="sidebar">
    <h3>ğŸ“¦ Inventory</h3>
    <a href="/admin/">âš™ï¸ Admin</a>
    <a href="/dashboard/">ğŸ“Š Dashboard</a>
    <a href="#">ğŸ§¾ Purchases</a>
    <a href="#">ğŸ·ï¸ Products</a>
    <a href="#">ğŸ‘¥ Suppliers</a>
  </div>

  <div class="content">
    <h2 class="mb-4">Welcome to Dashboard</h2>

    <div class="row mb-4">
      <div class="col-md-3">
        <div class="card p-3 shadow-sm">
          <h6>ğŸ§¾ Total Purchases</h6>
          <h3>{{ purchase_count }}</h3>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card p-3 shadow-sm">
          <h6>ğŸ·ï¸ Products</h6>
          <h3>{{ product_count }}</h3>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card p-3 shadow-sm">
          <h6>ğŸ‘¥ Suppliers</h6>
          <h3>{{ supplier_count }}</h3>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card p-3 shadow-sm bg-light">
          <h6>ğŸ’° Todayâ€™s Purchase</h6>
          <h3>${{ daily_purchases|floatformat:2 }}</h3>
        </div>
      </div>
    </div>

    <div class="row mb-4">
      <div class="col-md-6">
        <div class="card p-3 shadow-sm">
          <h6>ğŸ“… Monthly Total</h6>
          <h3>${{ monthly_purchases|floatformat:2 }}</h3>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card p-3 shadow-sm">
          <h6>âš ï¸ Low Stock Alerts</h6>
          {% if low_stock %}
            <ul>
              {% for p in low_stock %}
                <li>{{ p.name }} â€” <span class="low-stock">Only {{ p.stock }} left</span></li>
              {% endfor %}
            </ul>
          {% else %}
            <p>No low stock items ğŸ‰</p>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="card p-4 shadow-sm">
      <h5 class="mb-3">ğŸ“Š Last 7 Days Purchases</h5>
      <canvas id="salesChart"></canvas>
    </div>
  </div>

  <script>
    const ctx = document.getElementById('salesChart');
    new Chart(ctx, {
      type: 'line',
      data: {
        labels: {{ chart_labels|safe }},
        datasets: [{
          label: 'Total Purchase ($)',
          data: {{ chart_data|safe }},
          borderColor: '#2563eb',
          backgroundColor: 'rgba(37,99,235,0.2)',
          fill: true,
          tension: 0.4
        }]
      },
      options: { scales: { y: { beginAtZero: true } } }
    });
  </script>
</body>
</html>
